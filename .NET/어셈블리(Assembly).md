어셈블리(Assembly)에 대하여
=======
- 어셈블리는 .NET기반 애플리케이션에 대한 배포, 버전 제어, 재사용, 활성화 범위 및 보안 권한의 기본 단위를 형성
- 어셈블리는 서로 함께 사용되어 논리적 기능 단위를 형성하도록 빌드되는 형식 및 리소스의 컬렉션
- 실행 파일(.exe) 또는 동적 연결 라이브러리(.dll)파일의 형태를 가지며 .NET 애플리케이션의 구성 요소
- 형식 구현을 인식하는 데 필요한 정보와 함께 공용 언어 런타임을 제공
<br/><br/>
- .NET 및 .NET Framework에서, 소스 코드 파일 1개 이상에서 어셈블리를 빌드할 수 있음
- .NEY Framework에서, 어셈블리 모듈을 하나 이상 포함할 수 있음
- 대규모 프로젝트를 계획하여 여러 개발자가 작업하는 별도의 소스 코드 파일이나 모듈을 결합하여 단일 어셈블리를 만들 수 있음

속성
-----
1. .exe 또는 dll파일로 구현
2. .NET Framework를 대상으로 하는 라이브러리의 경우 GAC(전역 어셈블리 캐시)에 어셈블리를 넣으면 애플리케이션간에 어셈블리를 공유할 수 있음
3. GAC에 어셈블리를 포함하려면 먼저 강력한 이름의 어셈블리를 만들어야함
4. 어셈블리는 필요한 경우에만 메모리에 로드, 사용되지 않는 경우에는 로드되지 않음. 대규모 프로젝트에서 리소스를 관리하는 효율적인 방법일 수 있음
5. 리플렉션을 사용하여 프로그래밍 방식으로 어셈블리에 대한 정보를 얻을 수 있음
6. .NET 및 .NET Framework에서 MetadataLoadContext 클래스를 사용하여 어셈블리를 검사하기 위해 로드할 수 있음, MetadataLoadContext는 Assembly.ReflectionOnlyLoad 메소드를 바꿈

### 리플렉션
- 리플렉션은 어셈블리, 모듈 및 형식을 설명하는 개체를 제공
- 리플렉션을 사용하면 동적으로 형식 인스턴스를 만들거나, 형식을 기존 개체에 바인딩하거나,
- 기존 개체에서 형식을 가져와 해당 메서드를 호출하거나, 필드 및 속성에 액세스할 수 있음
- 코드에서 특성을 사용하는 경우 리플렉션은 특성에 대한 액세스를 제공

```cs
// 라이브러리 추가
using System;
using System.Reflection;

// GetType 사용
int i = 42;
Type type = i.GetType();
Console.WriteLine(type);

// 리플렉션을 사용하여 어셈블리의 정보를 얻기
Assembly info = typeof(int).Assembly;
Console.WriteLine(info);
```

- C#키워드 protected 및 internal은 IL(중간 언어)에서 아무런 의미가 없으며 리플렉션 API에서 사용되지 않음
- IL의 해당 용어는 Family 및 Assembly
- 리플렉션을 사용하는 internal 메서드를 식별하려면 IsAssembly 속성을 사용
- protected internal메서드를 실별하려면 IsFamilyOrAssembly를 사용

#### 리플렉션이 유용한 상황
- 프로그램 메타데이터의 특성에 엑세스해야 하는 경우
- 어셈블리에서 형식을 검사하고 인스턴스화하려는 경우
- 런타임에 새 형식을 빌드하려는 경우, System.Reflection.Emit의 클래스를 사용
- 런타임에 바인딩을 수행하고 런타임에 생성된 형식의 메서드에 엑세스하려는 경우

공용 언어 런타임의 어셈블리
-----

- 공용언어 런타임이 실행하는 코드, 각 어셈블리는 진입점을 하나만 가질 수 있음
- 보안 경계: 어셈블리는 권한이 요청되고 허용되는 단위
- 형식 경계: 각 형식의 ID에는 해당 형식이 존재하는 어셈블리의 이름이 포함됨, 한 어셈블리의 범위에서 로드된 형식과 다른 어셈블리의 범위에서 로드된 형식과 다름
- 참조 범위 경계: 어셈블리 매니페스트에는 형식을 확인하고 리소스 요청을 충족하는 데 사용되는 메타데이터가 있음, 매니페스트는 어셈블리 외부에 노충할 형식과 리소스를 지정하고, 해당 어셈블리가 종속된 다른 어셈블리를 열거함, 이식가능파일의 MSIL코드는 연결된 어셈블리 매니페스트가 없으면 실행되지 않음
- 버전 경계: 어셈블리는 공용 언어 런타임에서 가장 작은 버전 지정 가능 단위, 동일한 어셈블리의 모든 형식과 리소스는 하나의 단위로 버전이 지정, 어셈블리 매니페스트는 종속 어셈블리에 지정한 버전 종속성을 설명
- 배포 단위: 애플리케이션이 시작될 때 애플리케이션이 처음으로 호출하는 어셈블리만 있어야 함, 지역화 리소스 또는 유틸리티가 포함된 어셈블리 등의 다른 어셈블리는 요청 시 검색할 수 있음, 이렇게 하면 처음 다운로드될 때 앱이 단순해짐


어셈블리 만들기
------------
- 어셈블리는 정적 또는 동적이 될 수 있음
- 정적 어셈블리는 PE(이식 가능한 실행)파일로 디스크에 저장
- 정적 어셈블리에는 인터페이스와 클래스뿐 아니라 비트맵, JPEG파일, 기타 리소스 파일 같은 리소스가 포함될 수 있음
- 메모리에서 직접 실행되며 실행 전에 디스크에 저장되지 않는 동적 어셈블리를 만들 수도 있음
- 동적 어셈블리는 실행된 후에 디스크에 저장할 수 있음
<br/><br/>
- .dll 또는 .exe파일을 만들 수 있는 개발 도구를 사용할 수 있음
- Window SDK의 도구를 사용하여 다른 개발 환경의 모듈이 포함된 어셈블리를 만들 수 있음
- System.Reflection.Emit 등의 공용 언어 런타임 API를 사용하여 동적 어셈블리를 만들 수 있음 
- Visual Studio에서 또는 .NET Core 명령중 인터페이스 도구를 사용하여 어셈블리를 빌드하거나 명령줄 컴파일러라를 사용하여 .NET Framework 어셈블리를 빌드하여 어셈블리를 컴파일 함

어셈블리 매니페스트
------------
- 정적 또는 동적 어셈블리인지 여부에 상관없이 모든 어셈블리는 어셈블리 요소가 서로 어떻게 연관되는지를 설명하는 데이터 컬렉션을 포함
- 어셈블리 메타데이터는 어셈블리 매니페스트에 들어 있음
- 어셈블리 매니페스트는 어셈블리의 버전 요구 사항과 보안 ID를 지정하는 데 필요한 모든 메타데이터와 어셈블리의 범위를 정의하고 리소스나 클래스에 대한 참조를 확인하는데 모든 메타데이터를 포함
- 어셈블리 매니페스트는 MSIL코드가 있는 PE(.exe 또는 .dll)파일에 저장되거나 어셈블리 매니페스트 정보만 포함하는 독립 실행형 PE파일에 저장
<br/><br/>
### 기능
1. 어셈블리를 구성하고 있는 파일을 열거
2. 어셈블리의 형식 및 리소스로의 참고자 해당 선언 및 구현이 포함된 파일에 매핑되는 방법을 관리
3. 어셈블리가 종속된 다른 어셈블리를 열거
4. 어셈블리 소비자와 어셈블리의 구현 정보 간의 간접 참조 수준을 제공
5. 어셈블리 자체 설명되도록 렌더링

### 내용
| 정보 | 설명 |
|---|---|
|어셈블리 이름| 어셈블리 이름을 나타내는 텍스트 문자열|
|버전 번호| 주 버전 번호와 부 버전 번호 및 수정 번호와 빌드 번호, 공용 언어 런타임은 이들 번호를 사용하여 버전 정책을 적용|
|culture| 어셈블리에서 지원하는 문화권 또는 언어, 이 정보는 특정 어셈블리를 문화권 또는 언어 관련 정보를 포함하는 위성 어셈블리로 지정할 때만 사용해야 함, 문화권 정보를 포함하는 어셈블리는 자동으로 위성 어셈블리로 간주 |
|강력한 이름 정보 | 어셈블리에 강력한 이름을 지정하는 경우 게시자의 공개 키|
|어셈블리에 포함된 파일 목록|어셈블리에 포함된 각 파일의 해시와 파일 이름, 어셈블리를 구성하는 모든 파일은 어셈블리 매니페스트가 포함된 파일과 동일한 디렉터리에 위치해야함|
|형식 참조 정보| 이 정보는 형식 참조를 해당 선언 및 구현이 포함된 파일에 매핑하는 데 사용되며 어셈블리에서 내보내는 형식에 대해 사용|
|참조된 어셈블리에 대한 정보| 어셈블리에서 정적으로 참조하는 다른 어셈블리의 목록, 각 참조는 종속 어셈블리의 이름, 어셈블리 메타데이터 및 공개키를 포함|

어셈블리에 대한 참조 추가
-----
- 애플리케이션에서 어셈블리를 사용하려면 어셈블리에 대한 참조를 추가해야함
- 어셈블리가 참조되면 해당 코드가 소스 파일에 속해 있는 것처럼 네임스페이스의 액세스 가능한 모든 유형, 속성, 메서드 및 기타 멤버를 애플리케이션에서 사용할 수 있음

참고자료
------
https://docs.microsoft.com/ko-kr/dotnet/standard/assembly/ - 어셈블리    
https://docs.microsoft.com/ko-kr/dotnet/csharp/programming-guide/concepts/reflection - 리플렉션
https://docs.microsoft.com/ko-kr/dotnet/standard/assembly/manifest - 어셈블리 매니페스트